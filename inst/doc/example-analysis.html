<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Examples of using eventglm and interpreting the results</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Examples of using eventglm and interpreting the results</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(survival)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#&gt; Warning: package &#39;survival&#39; was built under R version 4.0.3</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(eventglm)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; Attaching package: &#39;eventglm&#39;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; The following objects are masked from &#39;package:survival&#39;:</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; </span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt;     colon, mgus2</span></span></code></pre></div>
<div id="colon-cancer-treatment-and-time-to-death-standard-survival" class="section level1">
<h1>Colon cancer treatment and time to death (standard survival)</h1>
<p>Our first example concerns the <code>colon</code> dataset, which is included in the package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>?eventglm<span class="op">::</span>colon</span></code></pre></div>
<p>This is a randomized trial, so the main interest is in comparing the distributions of time to death between the three treatment arms. Let’s start with a survival curve.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>sfit &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx, <span class="dt">data =</span> colon)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">plot</span>(sfit, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;slateblue&quot;</span>, <span class="st">&quot;salmon&quot;</span>), </span>
<span id="cb3-3"><a href="#cb3-3"></a>     <span class="dt">xlab =</span> <span class="st">&quot;days since registration&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;survival&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;slateblue&quot;</span>, <span class="st">&quot;salmon&quot;</span>), </span>
<span id="cb3-5"><a href="#cb3-5"></a>       <span class="dt">legend =</span> <span class="kw">names</span>(sfit<span class="op">$</span>strata))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we know, hazard ratios are difficult to interpret as causal effects, even in randomized controlled trials. Better options for summarizing the effect of treatment are the survival at a particular time, or the restricted mean survival up to a given time. Let’s compare the survival at 7 years, or about 2500 days since registration.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">plot</span>(sfit[<span class="dv">1</span>], <span class="dt">conf.int =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;days since registration&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;survival&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>seg0 &lt;-<span class="st"> </span><span class="kw">summary</span>(sfit[<span class="dv">1</span>], <span class="dt">times =</span> sfit[<span class="dv">1</span>]<span class="op">$</span>time[sfit[<span class="dv">1</span>]<span class="op">$</span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2500</span>])</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">rect</span>(<span class="kw">c</span>(<span class="dv">0</span>, seg0<span class="op">$</span>time), <span class="dv">0</span>, <span class="kw">c</span>(seg0<span class="op">$</span>time, <span class="dv">2500</span>), <span class="kw">c</span>(seg0<span class="op">$</span>surv), </span>
<span id="cb4-5"><a href="#cb4-5"></a>     <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;grey80&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">lines</span>(sfit[<span class="dv">1</span>], <span class="dt">conf.int =</span> <span class="ot">FALSE</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">2500</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">points</span>(<span class="dt">x =</span> <span class="dv">2500</span>, <span class="dt">y =</span> <span class="kw">summary</span>(sfit[<span class="dv">1</span>], <span class="dt">times =</span> <span class="dv">2500</span>)<span class="op">$</span>surv)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the figure above, we plot only the survival curve in the observation group. The vertical dotted line is at the time of interest (tmax = 2500 days). The open point is at the estimated survival probability at time tmax, i.e., <span class="math inline">\(P(T &gt; tmax)\)</span> and the shaded area represents the restricted mean survival up to tmax, i.e., <span class="math inline">\(E\{\min(T, tmax)\} = \int_0^{tmax} P(T &gt; u) \, du\)</span>. We can estimate these things using the <code>survival</code> package:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>colon.sfit &lt;-<span class="st"> </span><span class="kw">summary</span>(sfit, <span class="dt">times =</span> <span class="dv">2500</span>, <span class="dt">rmean =</span> <span class="dv">2500</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>colon.sfit</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; Call: survfit(formula = Surv(time, status) ~ rx, data = colon)</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;                 rx=Obs </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;         time       n.risk      n.event     survival      std.err lower 95% CI </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;     2.50e+03     5.00e+01     1.65e+02     4.55e-01     2.98e-02     4.00e-01 </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; upper 95% CI </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;     5.18e-01 </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; </span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;                 rx=Lev </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;         time       n.risk      n.event     survival      std.err lower 95% CI </span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;     2.50e+03     5.80e+01     1.57e+02     4.85e-01     2.92e-02     4.31e-01 </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; upper 95% CI </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;     5.46e-01 </span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">#&gt;                 rx=Lev+5FU </span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">#&gt;         time       n.risk      n.event     survival      std.err lower 95% CI </span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">#&gt;     2.50e+03     6.50e+01     1.21e+02     5.88e-01     2.96e-02     5.33e-01 </span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">#&gt; upper 95% CI </span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">#&gt;     6.49e-01</span></span></code></pre></div>
<p>And we can now do inference using the <code>eventglm</code> package. First, we fit a regression model for the cumulative incidence, or 1 - survival:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>colon.cifit &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx, <span class="dt">time =</span> <span class="dv">2500</span>, <span class="dt">data =</span> colon)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="kw">summary</span>(colon.cifit)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt; </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; Call:</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; cumincglm(formula = Surv(time, status) ~ rx, time = 2500, data = colon)</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; -0.5875  -0.4902  -0.3467   0.4863   2.1103  </span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt; (Intercept)  0.54345    0.02946  18.449  &lt; 2e-16 ***</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co">#&gt; rxLev       -0.02907    0.04173  -0.697  0.48596    </span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; rxLev+5FU   -0.13176    0.04186  -3.148  0.00165 ** </span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt;     Null deviance: 253.10  on 928  degrees of freedom</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; Residual deviance: 250.15  on 926  degrees of freedom</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; </span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>se.ci &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">vcov</span>(colon.cifit, <span class="dt">type =</span> <span class="st">&quot;robust&quot;</span>)))</span>
<span id="cb6-27"><a href="#cb6-27"></a>b.ci &lt;-<span class="st"> </span>colon.cifit<span class="op">$</span>coefficients</span>
<span id="cb6-28"><a href="#cb6-28"></a>conf.ci &lt;-<span class="st"> </span><span class="kw">confint</span>(colon.cifit)</span></code></pre></div>
<p>We find that compared to observation alone, the Levamisole alone treatment group has a -0.03 difference in the cumulative incidence of death at 2500 days, with 95% confidence interval -0.11, 0.05, while the Levamisole plus 5-FU group has a -0.13 difference in the cumulative incidence of death at 2500 days, with 95% confidence interval -0.21, -0.05. This roughly agrees with the Kaplan-Meier estimates from survfit above:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">cbind</span>(<span class="dt">eventglm =</span> b.ci, </span>
<span id="cb7-2"><a href="#cb7-2"></a>      <span class="dt">survfit =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>colon.sfit<span class="op">$</span>surv[<span class="dv">1</span>], </span>
<span id="cb7-3"><a href="#cb7-3"></a>  (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>colon.sfit<span class="op">$</span>surv[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]) <span class="op">-</span><span class="st"> </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">rep</span>(colon.sfit<span class="op">$</span>surv[<span class="dv">1</span>], <span class="dv">2</span>))))</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt;                eventglm     survfit</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; (Intercept)  0.54345139  0.54479221</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; rxLev       -0.02907499 -0.02990601</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; rxLev+5FU   -0.13175778 -0.13301654</span></span></code></pre></div>
<p>We can fit another model using the log link to obtain estimates of the log relative risks comparing the active treatment arms to the observation arm:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>colon.rr &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx, <span class="dt">time =</span> <span class="dv">2500</span>, </span>
<span id="cb8-2"><a href="#cb8-2"></a>                      <span class="dt">data =</span> colon, <span class="dt">link =</span> <span class="st">&quot;log&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>br.ci &lt;-<span class="st"> </span>colon.rr<span class="op">$</span>coefficients</span>
<span id="cb8-4"><a href="#cb8-4"></a>confr.ci &lt;-<span class="st"> </span><span class="kw">confint</span>(colon.rr)</span></code></pre></div>
<p>We find that the estimated probability of death before 2500 days in the Levamisole alone arm is 0.95 times lower compared to observation with 95% confidence interval 0.81, 1.1 and the estimated probability of death before 2500 days in the Levamisole+5FU arm is 0.76 times lower compared to observation with 95% confidence interval 0.63, 0.9. If odds ratios are of interest, then the <code>link = &quot;logit&quot;</code> option can be used instead. Another interesting option is the <code>link = &quot;cloglog&quot;</code>: the complementary log log link for the cumulative incidence implies proportional hazards. Thus models using the cloglog link applied at various time points can be used to assess the proportional hazards assumption <span class="citation">(Perme and Andersen 2008)</span>. Other options for link functions are probit, inverse, <span class="math inline">\(\mu^{-2}\)</span>, square root, and users can define custom link function. It is not immediately clear what the interpretation of the regression coefficients would be in these cases, but they are possible. See the <code>stats::family</code> help file for more details.</p>
<p>Now for the restricted mean:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>colon.rmfit &lt;-<span class="st"> </span><span class="kw">rmeanglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx, <span class="dt">time =</span> <span class="dv">2500</span>, <span class="dt">data =</span> colon)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">summary</span>(colon.rmfit)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; rmeanglm(formula = Surv(time, status) ~ rx, time = 2500, data = colon)</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt; -1839.4   -903.8    620.9    829.9    848.1  </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; (Intercept) 1667.403     49.949  33.382  &lt; 2e-16 ***</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; rxLev         -6.074     71.739  -0.085  0.93253    </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt; rxLev+5FU    194.954     70.498   2.765  0.00569 ** </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt; </span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt; </span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt;     Null deviance: 734414066  on 928  degrees of freedom</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">#&gt; Residual deviance: 726392934  on 926  degrees of freedom</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt; </span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>se.rm &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">vcov</span>(colon.rmfit, <span class="dt">type =</span> <span class="st">&quot;robust&quot;</span>)))</span>
<span id="cb9-27"><a href="#cb9-27"></a>b.rm &lt;-<span class="st"> </span>colon.rmfit<span class="op">$</span>coefficients</span>
<span id="cb9-28"><a href="#cb9-28"></a>conf.rm &lt;-<span class="st"> </span><span class="kw">confint</span>(colon.rmfit)</span></code></pre></div>
<p>We find that compared to observation alone, the Levamisole alone treatment group has a -6.07 difference in the mean time to death up to 2500 days, with 95% confidence interval -146.68, 134.53, while the Levamisole plus 5-FU group has a 194.95 difference in the mean time to death up to 2500 days, with 95% confidence interval 56.78, 333.13. Again, this roughly agrees with the Kaplan-Meier estimates from survfit above:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">cbind</span>(<span class="dt">eventglm =</span> b.rm, </span>
<span id="cb10-2"><a href="#cb10-2"></a>      <span class="dt">survfit =</span> <span class="kw">c</span>(colon.sfit<span class="op">$</span>table[<span class="dv">1</span>, <span class="dv">5</span>], </span>
<span id="cb10-3"><a href="#cb10-3"></a>colon.sfit<span class="op">$</span>table[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">5</span>] <span class="op">-</span><span class="st"> </span>colon.sfit<span class="op">$</span>table[<span class="dv">1</span>, <span class="dv">5</span>]))</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;               eventglm     survfit</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; (Intercept) 1667.40308 1666.948078</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; rxLev         -6.07367   -5.708803</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; rxLev+5FU    194.95446  195.313754</span></span></code></pre></div>
<p>A key advantage of the regression approach is that it gives us the ability to adjust or model other covariates. In this example, since it is a randomized trial, we know that all covariates are independent of treatment assignment. However, several variables are associated with time to death, so in this case they would be called “precision variables”. We would expect that adjusting for age, or the number of positive lymph nodes (more than 4) in the above models would reduce the standard error estimates of the treatment effects, without changing the coefficient estimates. Let’s find out:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>colon.ci.adj &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4, <span class="dt">time =</span> <span class="dv">2500</span>, <span class="dt">data =</span> colon)</span>
<span id="cb11-2"><a href="#cb11-2"></a>colon.rm.adj &lt;-<span class="st"> </span><span class="kw">rmeanglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4, <span class="dt">time =</span> <span class="dv">2500</span>, <span class="dt">data =</span> colon)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">summary</span>(colon.rm.adj)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; rmeanglm(formula = Surv(time, status) ~ rx + age + node4, time = 2500, </span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt;     data = colon)</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; </span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; -2035.7   -788.5    443.2    647.6   1385.7  </span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; </span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; (Intercept) 2067.576    151.579  13.640  &lt; 2e-16 ***</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; rxLev          3.421     67.516   0.051  0.95958    </span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; rxLev+5FU    185.349     67.365   2.751  0.00593 ** </span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; age           -3.735      2.391  -1.562  0.11824    </span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; node4       -644.960     64.854  -9.945  &lt; 2e-16 ***</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; ---</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; </span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; </span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt;     Null deviance: 734414066  on 928  degrees of freedom</span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">#&gt; Residual deviance: 650039827  on 924  degrees of freedom</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt; </span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>The estimates don’t change (much) and the standard errors reduce by about 5%.</p>
</div>
<div id="monoclonal-gammopathy-data-competing-risks" class="section level1">
<h1>Monoclonal gammopathy data (Competing risks)</h1>
<p>Our next example involves the <code>mgus2</code> dataset, included in the package:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## ?mgus2</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">head</span>(mgus2)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt;   id age sex dxyr  hgb creat mspike ptime pstat futime death etime event</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; 1  1  88   F 1981 13.1   1.3    0.5    30     0     30     1    30 death</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; 2  2  78   F 1968 11.5   1.2    2.0    25     0     25     1    25 death</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; 3  3  94   M 1980 10.5   1.5    2.6    46     0     46     1    46 death</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; 4  4  68   M 1977 15.2   1.2    1.2    92     0     92     1    92 death</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt; 5  5  90   F 1973 10.7   0.8    1.0     8     0      8     1     8 death</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; 6  6  90   M 1990 12.9   1.0    0.5     4     0      4     1     4 death</span></span></code></pre></div>
<p>This dataset has a number of covariates, and the time until progression to plasma cell malignancy (PCM), or death. Here the event PCM is of primary interest, with death being a competing event. The data are described and analyzed in the survival vignette (section 2.3.2):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>crfit &lt;-<span class="st"> </span><span class="kw">survfit</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex, eventglm<span class="op">::</span>mgus2)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">summary</span>(crfit, <span class="dt">times =</span> <span class="dv">120</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; Call: survfit(formula = Surv(etime, event) ~ sex, data = eventglm::mgus2)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt;                 sex=F </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt;     time   n.risk  n.event  P((s0))   P(pcm) P(death) </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; 120.0000 214.0000 331.0000   0.4456   0.0739   0.4805 </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; </span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt;                 sex=M </span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt;     time   n.risk  n.event  P((s0))   P(pcm) P(death) </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; 120.0000 210.0000 450.0000   0.3695   0.0553   0.5752</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="kw">print</span>(crfit, <span class="dt">rmean =</span> <span class="dv">120</span>)</span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; Call: survfit(formula = Surv(etime, event) ~ sex, data = eventglm::mgus2)</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; </span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt;                n nevent    rmean*</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; sex=F, (s0)  631      0 82.983485</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co">#&gt; sex=M, (s0)  753      0 74.808346</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; sex=F, pcm   631     59  4.794595</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; sex=M, pcm   753     56  3.501305</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; sex=F, death 631    370 32.221921</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; sex=M, death 753    490 41.690349</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt;    *mean time in state, restricted (max time = 120 )</span></span>
<span id="cb13-23"><a href="#cb13-23"></a></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="kw">plot</span>(crfit, <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,  <span class="dt">noplot=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb13-25"><a href="#cb13-25"></a>     <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">xscale=</span><span class="dv">12</span>,</span>
<span id="cb13-26"><a href="#cb13-26"></a>     <span class="dt">xlab=</span><span class="st">&quot;Years post diagnosis&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;P(state)&quot;</span>)</span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="kw">legend</span>(<span class="dv">240</span>, <span class="fl">.65</span>, <span class="kw">c</span>(<span class="st">&quot;Female, death&quot;</span>, <span class="st">&quot;Male, death&quot;</span>, <span class="st">&quot;malignancy&quot;</span>, <span class="st">&quot;(s0)&quot;</span>),</span>
<span id="cb13-28"><a href="#cb13-28"></a>       <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">bty=</span><span class="st">&#39;n&#39;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">120</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can get similar estimates for the cumulative incidence of pcm at 10 years and the expected lifetime lost due to pcm up to 10 years with similar commands as above. Note the <code>cause</code> option to specify the cause of interest.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>mgfitci &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex, <span class="dt">cause =</span> <span class="st">&quot;pcm&quot;</span>, <span class="dt">time =</span> <span class="dv">120</span>, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                   <span class="dt">data =</span> mgus2)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">summary</span>(mgfitci)</span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; cumincglm(formula = Surv(etime, event) ~ sex, time = 120, cause = &quot;pcm&quot;, </span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt;     data = mgus2)</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; -0.08163  -0.07447  -0.06306  -0.05536   1.23923  </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; </span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">#&gt; (Intercept)  0.07383    0.01086   6.800 1.04e-11 ***</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">#&gt; sexM        -0.01857    0.01384  -1.342     0.18    </span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">#&gt; </span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">#&gt; </span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">#&gt;     Null deviance: 88.507  on 1383  degrees of freedom</span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co">#&gt; Residual deviance: 88.388  on 1382  degrees of freedom</span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="co">#&gt; </span></span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb14-27"><a href="#cb14-27"></a></span>
<span id="cb14-28"><a href="#cb14-28"></a>mgfitrmean &lt;-<span class="st"> </span><span class="kw">rmeanglm</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex, <span class="dt">cause =</span> <span class="st">&quot;pcm&quot;</span>, <span class="dt">time =</span> <span class="dv">120</span>, </span>
<span id="cb14-29"><a href="#cb14-29"></a>                       <span class="dt">data =</span> mgus2)</span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="kw">summary</span>(mgfitrmean)</span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co">#&gt; </span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="co">#&gt; rmeanglm(formula = Surv(etime, event) ~ sex, time = 120, cause = &quot;pcm&quot;, </span></span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="co">#&gt;     data = mgus2)</span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co">#&gt; </span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">#&gt;  -4.971   -4.863   -3.678   -3.508  113.292  </span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">#&gt; </span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="co">#&gt; (Intercept)   4.7926     0.7883   6.080  1.2e-09 ***</span></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="co">#&gt; sexM         -1.2929     0.9902  -1.306    0.192    </span></span>
<span id="cb14-44"><a href="#cb14-44"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-45"><a href="#cb14-45"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-46"><a href="#cb14-46"></a><span class="co">#&gt; </span></span>
<span id="cb14-47"><a href="#cb14-47"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb14-48"><a href="#cb14-48"></a><span class="co">#&gt; </span></span>
<span id="cb14-49"><a href="#cb14-49"></a><span class="co">#&gt;     Null deviance: 450225  on 1383  degrees of freedom</span></span>
<span id="cb14-50"><a href="#cb14-50"></a><span class="co">#&gt; Residual deviance: 449652  on 1382  degrees of freedom</span></span>
<span id="cb14-51"><a href="#cb14-51"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb14-52"><a href="#cb14-52"></a><span class="co">#&gt; </span></span>
<span id="cb14-53"><a href="#cb14-53"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>Sex may be an important predictor of time to pcm, what about the other variables?</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mgfitci2 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>hgb, <span class="dt">cause =</span> <span class="st">&quot;pcm&quot;</span>, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                      <span class="dt">time =</span> <span class="dv">120</span>, <span class="dt">data =</span> mgus2)</span>
<span id="cb15-3"><a href="#cb15-3"></a>mgfitrmean2 &lt;-<span class="st"> </span><span class="kw">rmeanglm</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>hgb, <span class="dt">cause =</span> <span class="st">&quot;pcm&quot;</span>, </span>
<span id="cb15-4"><a href="#cb15-4"></a>                      <span class="dt">time =</span> <span class="dv">120</span>, <span class="dt">data =</span> mgus2)</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">summary</span>(mgfitrmean2)</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; </span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; Call:</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; rmeanglm(formula = Surv(etime, event) ~ sex + age + hgb, time = 120, </span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt;     cause = &quot;pcm&quot;, data = mgus2)</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; </span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt;  -7.081   -4.795   -4.034   -3.278  112.970  </span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; (Intercept)  3.98253    3.87360   1.028    0.304</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; sexM        -0.98992    0.99168  -0.998    0.318</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; age          0.04466    0.02941   1.518    0.129</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt; hgb         -0.18754    0.25091  -0.747    0.455</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">#&gt; (Dispersion parameter for quasi family taken to be 1)</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">#&gt; </span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt;     Null deviance: 448531  on 1370  degrees of freedom</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">#&gt; Residual deviance: 447319  on 1367  degrees of freedom</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">#&gt;   (13 observations deleted due to missingness)</span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">#&gt; AIC: NA</span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">#&gt; </span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>The objects returned by <code>cumincglm</code> and <code>rmeanglm</code> inherit from <code>glm</code>, so many methods are available. First, the <code>vcov</code> function has several options for calculation of the estimated variance of the estimated regression parameters. By default, the <code>robust</code> variance estimates are used, based on the Huber-White estimator. Other options are naive, and corrected, which are the corrected estimators suggested by <span class="citation">Overgaard et al. (2017)</span> which are based on a second order Von-Mises expansion. We can also use the bootstrap. This recalculated the pseudo-observations every time, but it is still pretty fast because of the C code. Let’s compare:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>nboot &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co"># use a bigger number for real</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>bootests &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> nboot, <span class="dt">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nboot) {</span>
<span id="cb16-4"><a href="#cb16-4"></a>  mgus.b &lt;-<span class="st"> </span>mgus2[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mgus2), <span class="dt">replace =</span> <span class="ot">TRUE</span>), ]</span>
<span id="cb16-5"><a href="#cb16-5"></a>  mgfitrmean.b &lt;-<span class="st"> </span><span class="kw">rmeanglm</span>(<span class="kw">Surv</span>(etime, event) <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>hgb, <span class="dt">cause =</span> <span class="st">&quot;pcm&quot;</span>, </span>
<span id="cb16-6"><a href="#cb16-6"></a>                      <span class="dt">time =</span> <span class="dv">120</span>, <span class="dt">data =</span> mgus.b)</span>
<span id="cb16-7"><a href="#cb16-7"></a>  bootests[i,] &lt;-<span class="st"> </span>mgfitrmean.b<span class="op">$</span>coefficients</span>
<span id="cb16-8"><a href="#cb16-8"></a>}</span>
<span id="cb16-9"><a href="#cb16-9"></a></span>
<span id="cb16-10"><a href="#cb16-10"></a>se.boot &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">cov</span>(bootests)))</span>
<span id="cb16-11"><a href="#cb16-11"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="dt">se.boot =</span> se.boot, </span>
<span id="cb16-12"><a href="#cb16-12"></a>      <span class="dt">se.robust =</span> <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">vcov</span>(mgfitrmean2))), </span>
<span id="cb16-13"><a href="#cb16-13"></a>      <span class="co">#se.corrected = sqrt(diag(vcov(mgfitrmean2, type = &quot;corrected&quot;))), </span></span>
<span id="cb16-14"><a href="#cb16-14"></a>      <span class="dt">se.naive =</span> <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">vcov</span>(mgfitrmean2, <span class="dt">type =</span> <span class="st">&quot;naive&quot;</span>)))), <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">se.boot</th>
<th align="right">se.robust</th>
<th align="right">se.naive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">4.139</td>
<td align="right">3.874</td>
<td align="right">4.749</td>
</tr>
<tr class="even">
<td align="left">sexM</td>
<td align="right">0.960</td>
<td align="right">0.992</td>
<td align="right">1.012</td>
</tr>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.030</td>
<td align="right">0.029</td>
<td align="right">0.041</td>
</tr>
<tr class="even">
<td align="left">hgb</td>
<td align="right">0.258</td>
<td align="right">0.251</td>
<td align="right">0.253</td>
</tr>
</tbody>
</table>
<p>The corrected estimator fails pretty often, because it doesn’t handle ties, and the benefits are negligible, and thus may be removed from the package in the future.</p>
<p>Residuals also work, using the scaling factor suggested by <span class="citation">Perme and Andersen (2008)</span>, as do predictions. Predicted restricted means give a possible method to predict individual event times, while the predicted cumulative incidence should be probabilities. Note that with the identity link, the predicted cumulative incidence is not guaranteed to be between 0 and 1.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">hist</span>(<span class="kw">predict</span>(mgfitrmean2, <span class="dt">newdata =</span> mgus2), </span>
<span id="cb17-2"><a href="#cb17-2"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Predicted lifetime lost due to PCM&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a></span>
<span id="cb18-2"><a href="#cb18-2"></a>mgus2<span class="op">$</span>prob.pcm10 &lt;-<span class="st"> </span><span class="kw">predict</span>(mgfitci2, <span class="dt">newdata =</span> mgus2)</span>
<span id="cb18-3"><a href="#cb18-3"></a>mgus2<span class="op">$</span>pseudo.ci &lt;-<span class="st"> </span>mgfitci<span class="op">$</span>y</span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="kw">summary</span>(mgus2<span class="op">$</span>prob.pcm10)</span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s </span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; 0.05169 0.05559 0.05695 0.06348 0.07297 0.07522      13</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>cutps &lt;-<span class="st"> </span><span class="kw">quantile</span>(mgus2<span class="op">$</span>prob.pcm10, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="dt">by =</span> <span class="fl">.1</span>), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>mgus2<span class="op">$</span>prob.cut &lt;-<span class="st"> </span><span class="kw">cut</span>(mgus2<span class="op">$</span>prob.pcm10, </span>
<span id="cb18-9"><a href="#cb18-9"></a>                      cutps)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a>pred.p &lt;-<span class="st"> </span>cutps[<span class="op">-</span><span class="kw">length</span>(cutps)] <span class="op">+</span><span class="st"> </span><span class="kw">diff</span>(cutps)</span>
<span id="cb18-12"><a href="#cb18-12"></a>obs.p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">by</span>(mgus2<span class="op">$</span>pseudo.ci, mgus2<span class="op">$</span>prob.cut, mean))</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="kw">plot</span>(obs.p <span class="op">~</span><span class="st"> </span>pred.p, <span class="dt">xlab =</span> <span class="st">&quot;predicted&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;observed&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHICAMAAACmrahdAAAAVFBMVEUAAAAAAFQAAIAAVFQAVKYAgMZUAABUAFRUVFRUpuOAAACAAFSApqaAxv+mVACmpoCmxqam4//GgADG/8bG///jplTj////xoD/46b//8b//+P///+qbD58AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM9ElEQVR4nO3di3ba2AGGUZLGnsZt0sYdgi/v/55FAhRsI4wuR/pBe6/VDI4JHOOvQjrosnqFYKu5BwDnCJRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKKNHOgKLjJXoOM+HLdKoEQTKNEESjSBEk2gRBMo0QTKZDrMav75N6PfcZaH4wqsXnv83gXKRFZHf3b9V2PecZaHI59AiSZQslkHJZuteG6OQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiVaoUBffu5OrPP171EejsUqE+h69X13Y3O4MejhWK4igb78bLJcf/s9+OFYsCKBPj/8ONzctLzJC5SLWIISrdQ66H4Rah2UYQptxT8/7LbiW5afAuVC5kGJJlCiCZRoAiVaoXnQP1cRMQ/KEGWWoC8/Wz+E7/NwLFexnUXuxnw4FqvUOuhm9ePUX3e/gBjLZiOJaAIlmkCJVjrQtWkmhrAEJZpAiSZQojmqk2iO6iSaY5KI5qhOolmCEs1RnURzVCfRzIMSTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEq1QoI+r1V19raSTV43v/HAsVqFz1H/7vW30rjoVuHPUM0S5q3xsvvx6dZUPBip3naTdFZJcJ4lBLEGJVngd9OiSXgMejuWyFU8086BEEyjRCgVav71vtWzDC5RtA6sLKii0kXS4hqyLydJm9XpJBuWmmXZMM3Ha6ujPT+928eNdpp6o3zFRz2kfAz35lm8Jyjw+BHr6Lb/UOuh+Efp+HXTV6PJw3KJ3Qba85Rfain9+2GXYsvy0BOX9W/q0gU79cFy9qw7UKsECjLIOenjrPjsJf2w9xlb8ZTNmXLmxtuJ3Gz67ven6D6bzfRW6SN0Dffl5V/+3bQJp5Od9FeiidQ/0MAvfNgU/8vO+CnTR+ixBd1Obj+eWoOPuLGIddLl6rYNWi9D1uXXQsXcWsRW/WH2mmepN+fPLTx91Mg47ixDNziJE6/kW/+33Y8vKZa11Z5Huz8uy9dlI+vJru1xsPalNzc4ijKPfNFP1xt32IebIz8uy9ZuorwKdbqKeBeu/BD07UT/e87JsvddB160nDRn3eVmuTodevJ+oH7Yzk0Bp9eawoOvYYZkFOH24mkCZ1yeHUfbZir8bPiqBLt2lh/f2WII+Dl8DFehSdT7svN8dN9VTDFqQCnRZep8OoXfJLz9N1POZ4efpsARlfCOeP6bPJ0nWQTmpxHmNbMUzVNHzbfU/aG6i5yXVNOeB63/Y8UTPS5iJz0/YZ2eRQZvvXZ+XDHOdN7PPErTLuZkGPy+zmqvLPwMY/Y6zPBzjmr3LPyMZ/Y6zPByjyOmyUeaozhGfl/ICu2wUOqpzvOelmOQuG47qXJ5r6LLhqM7FuIoF5geO6rx119llw1GdN+rKu2w4qvO23EqXDfOgN+HmumwI9JrdbpeNHoFWM6Dr86dYHvF5+WgBXTb6HNX57ffT/d3ro0M+JrakLhv95kGr6ygUngdd2O/hjEV22egX6OM2zrKfJK0uuM9tW3aXjT5v8XfPD9Vn8SXf4leX3Okm6fKtXhtJqy+/DhdEbFEtYp/uz8yWCvQdXZ5WZpqp7vOvX2cOYBLojgXmJ4oEWu+Kt9vK73sZmhtfB9XlpXp/1HluGrRabu6PTu59Ia+b/OXpsrM+O4t8fq3Oaum5HrQEvSm67K//iRvO7W73/PD17/p+m7aMTz3vrf0GdTmC/iduOD9Rv9n9alo39U88762sdupyTH2WoLvq2t68+z7vtW+467KIXuug1Xt865t33+e90kB1WVbHQJvTiqzOn1mkPkfjuftce6C6nEiZifr14SLHXa52fA3roLqcWpFAe14vPvf3rsvZ9Am0+pD97DFJRx9w9p6o/3Q8U9Siy9n13kg6d1RnzyVoF0XXBywwc/SfqD83zdTU+34ddDXS777IFpUuAxWaqD9s7bdGHBSoLpOVWYKO+Lzn/vmgB9HlVSiyDjrm8575970eQ5fXpchW/JG2I5em3orX5ZUqM1E/+cO1Po0ur9xtBqrLm3FTgery9hQKtMfOIv3p8oYF7SzSlS6XIGlnkQsHosslKXTYcYGdRXS5SPFLUAvMZSu1Dtqys8jFD6dLaoW24vvuLKJL3sqYB9UlLWYNVJd8ZrZAdcklMt7ioYVAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiFQ306b71isgC5SKFLkPTnDu57VpzAuUiZZag+4t7WIIyVLGrfFTX9xAoQxVbB3388kugDFZuI2m9+i5Qhiq4Ff90/w+BMlDJaaaXnyuBMoyJeqIVCnS78Dw3CypQLlQm0PXhIse9r3YMtSKBjnm9eJat0EedzcbRxkedDGEJSrRS66D7Rej7ddCVK3DTSbHP4ncZtiw/LUG5kHlQogmUaKUDXduKZwhLUKIJlGgCJZqdRYhmZxGi+aiTaHYWIZolKNEm3lmk38OxXHYWIZp5UKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRxjXz9AYEyqtXruL9cgTKm1dGfIz7gmHec5eEIIVCiCZRs1kHJZiueJREo0QRKNIESTaBEEyjRBEq02QKFi8wU6CSP3JmhnBI0lDMEOi1D6Uig0zKUjgQ6LUPpSKDTMpSOBDotQ+lIoNMylI4EOi1D6Uig0zKUjq5jlCyWQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiXaWIFuVqsvv95/8fxQHWB6d3RjCieH8vp0vx/Am2/POpTZX5XN/hDgH9O+Kp2MFOhm+9NtDj9h88XTX/u/aW5M4PRQNt9+b4O4e/fteYcy/6tSmfxV6WacQF9+ft/++Xj37ovN1793329ulHd6KLsb669/v/n2vEOZ/1WpVSOZ8lXpaJxAn+637xL1j/rmi/XhJ15P96OfHsqfZfnxt+cdyvyvyu6L79O+Kh2NFGj9ou+XCH++ePzndgWn/v/m4UZ5p4ey+fq/h3oEb74971Dmf1WqLx6r/0z5qnQ0TqC71Zf9SkzzxfPDdm3r9fH7a3NjAqeHsl7Vb2R3b78971Dmf1VeqzXQ7++/naVkoPvvTbsi2lLFl8Pya/5Av7xZWs35qpz8M0zRt/jd9+r1m+MbRZ0eym71ajuC+d/im6Hs7zTjq7L987Fait/+W3z7Ovjkc02nh7J77bcjmH8jqRnK/k4zviqHd/jb30g6PYux+7G3v5DmxihP1mcozw/7Ecw/zdQMZf5XpVl+3/w0U8s8cP0TV1sBzY0JnB7KevtWVv8a5p+ob4Yy/6vS/NWtT9RvX/XdR2XV1mnzxfbV332OdnRjAqeHsjlM6awn/FDvk6HM/6o07+pTviqd2FmEaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJlCiCZRoAiWaQIkmUKIJlGgCJZpAiSZQogmUaAIlmkCJJtCy6hNNH51/afPhXEyZ5+yKIdCy3uX3JtaT9+AtgZYl0IEEOtjTX/+9r8+n+Pyv/1QXSFgfn+jxP4e3+Opv76przH37/eEesw4/nEAH21b343Wz/d/ush3VRRLqiw9VF3jZrPaBVn/7/PC9uf3mHnP/BMkEOljdWnXe5PqE7/vruhzO8P24C3R/LvjXP7eP7zHf2PMJdLD9ueb3i8rdKuX273Ynn9//9eFaHtXtj/eYb+z5BDrY/houh0APVxBevwl0fy2POtAP95hz9OkEOti7QN9ewKx1CXp8jzlGfS0EOthuHfSxWgf9cTSRtL/20Kl10Pf3mGPU10Kggz3dV9dwWR3Kq4OrtnzW9V8fbcW//LyrQ/1wj7l/gmQCHezp/t/39eVk9ovGapazfvP+OA9aXXlmPw96fI9Zhx9OoINNc7XNpRLoYAItSaCDCbQkgRJNoEQTKNEESjSBEk2gRBMo0QRKNIESTaBEEyjRBEo0gRJNoEQTKNEESjSBEk2gRBMo0QRKNIES7f8bU7pXqXe0fQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="censoring-assumptions" class="section level1">
<h1>Censoring assumptions</h1>
<p>By default, we assume that time to censoring is independent of the time to the event, and of all covariates in the model. This is more restrictive than parametric survival models, or Cox regression, which only assumes that censoring time is conditionally independent of event time given the covariates in the model. We provide several options to relax that assumption using the <code>model.censoring</code> and <code>formula.censoring</code> options. The first is to compute stratified pseudo observations, which assumes that the censoring is independent given a set of categorical covariates:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>colon.ci.cen1 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4, <span class="dt">time =</span> <span class="dv">2500</span>, </span>
<span id="cb19-2"><a href="#cb19-2"></a>                           <span class="dt">data =</span> colon, <span class="dt">model.censoring =</span> <span class="st">&quot;stratified&quot;</span>, </span>
<span id="cb19-3"><a href="#cb19-3"></a>                           <span class="dt">formula.censoring =</span> <span class="op">~</span><span class="st"> </span>rx)</span></code></pre></div>
<p>Next, we can assume that the time to censoring follows a Cox model given a set of covariates. By default, the same covariate formula (right hand side) as the main model is used, but any formula can be specified. We can also use Aalens additive hazards model instead of a Cox model for the censoring distribution. Then inverse probability of censoring weighted pseudo observations are used <span class="citation">(Overgaard, Parner, and Pedersen 2019)</span>. According to our simulation study, the stratified option works quite well even when the censoring model is misspecified, and the Aalen additive model tends to work better than the Cox model.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>colon.ci.cen2 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4, <span class="dt">time =</span> <span class="dv">2500</span>, </span>
<span id="cb20-2"><a href="#cb20-2"></a>                           <span class="dt">data =</span> colon, <span class="dt">model.censoring =</span> <span class="st">&quot;coxph&quot;</span>, </span>
<span id="cb20-3"><a href="#cb20-3"></a>                           <span class="dt">formula.censoring =</span> <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4)</span>
<span id="cb20-4"><a href="#cb20-4"></a>colon.ci.cen3 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(time, status) <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4, <span class="dt">time =</span> <span class="dv">2500</span>, </span>
<span id="cb20-5"><a href="#cb20-5"></a>                           <span class="dt">data =</span> colon, <span class="dt">model.censoring =</span> <span class="st">&quot;aareg&quot;</span>, </span>
<span id="cb20-6"><a href="#cb20-6"></a>                           <span class="dt">formula.censoring =</span> <span class="op">~</span><span class="st"> </span>rx <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>node4)</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="st">&quot;indep&quot;</span> =<span class="st"> </span>colon.ci.adj<span class="op">$</span>coefficients, </span>
<span id="cb20-9"><a href="#cb20-9"></a>      <span class="st">&quot;strat&quot;</span> =<span class="st"> </span>colon.ci.cen1<span class="op">$</span>coefficients, </span>
<span id="cb20-10"><a href="#cb20-10"></a>      <span class="st">&quot;coxipcw&quot;</span> =<span class="st"> </span>colon.ci.cen2<span class="op">$</span>coefficients, </span>
<span id="cb20-11"><a href="#cb20-11"></a>      <span class="st">&quot;aalenipcw&quot;</span> =<span class="st"> </span>colon.ci.cen3<span class="op">$</span>coefficients), <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">indep</th>
<th align="right">strat</th>
<th align="right">coxipcw</th>
<th align="right">aalenipcw</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.318</td>
<td align="right">0.314</td>
<td align="right">0.535</td>
<td align="right">0.596</td>
</tr>
<tr class="even">
<td align="left">rxLev</td>
<td align="right">-0.034</td>
<td align="right">-0.035</td>
<td align="right">-0.034</td>
<td align="right">-0.036</td>
</tr>
<tr class="odd">
<td align="left">rxLev+5FU</td>
<td align="right">-0.127</td>
<td align="right">-0.128</td>
<td align="right">-0.127</td>
<td align="right">-0.127</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.002</td>
<td align="right">0.002</td>
<td align="right">0.002</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">node4</td>
<td align="right">0.332</td>
<td align="right">0.334</td>
<td align="right">0.335</td>
<td align="right">0.334</td>
</tr>
</tbody>
</table>
</div>
<div id="relative-survivalnet-survival" class="section level1">
<h1>Relative survival/net survival</h1>
<p>Following Professor Paul Lambert’s example here: <a href="https://pclambert.net/software/stpp/using_stpp/" class="uri">https://pclambert.net/software/stpp/using_stpp/</a> , let’s load the datasets:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">library</span>(data.table)</span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co"># from https://pclambert.net/data/colon.dta</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>colon2 &lt;-<span class="st"> </span>rio<span class="op">::</span><span class="kw">import</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;colon.dta&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;eventglm&quot;</span>))</span>
<span id="cb21-5"><a href="#cb21-5"></a>colon2<span class="op">$</span>surv_mm_trunc &lt;-<span class="st"> </span><span class="kw">ifelse</span>(colon2<span class="op">$</span>surv_mm <span class="op">&gt;</span><span class="st"> </span><span class="fl">120.5</span>, <span class="fl">120.5</span>, colon2<span class="op">$</span>surv_mm)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>colon2<span class="op">$</span>death &lt;-<span class="st"> </span>colon2<span class="op">$</span>status <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb21-8"><a href="#cb21-8"></a>colon2<span class="op">$</span>death[colon2<span class="op">$</span>surv_mm <span class="op">&gt;</span><span class="st"> </span>colon2<span class="op">$</span>surv_mm_trunc] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb21-9"><a href="#cb21-9"></a></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co"># from https://pclambert.net/data/popmort.dta</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>lifetab &lt;-<span class="st"> </span><span class="kw">data.table</span>(rio<span class="op">::</span><span class="kw">import</span>(<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;popmort.dta&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;eventglm&quot;</span>)))</span></code></pre></div>
<p>Now we will estimate the marginal relative survival using the approach described in <span class="citation">Pavlič and Pohar Perme (2019)</span>, which is based on the estimator:</p>
<p><span class="math display">\[
RS(t) = n^{-1}\sum_{i = 1}^n\frac{PO_i(t)}{S_{P}(t | D)}, 
\]</span></p>
<p>where <span class="math inline">\(S_{P}(t | D)\)</span> is the survival probability based on the life tables for the demographics <span class="math inline">\(D\)</span> of patient <span class="math inline">\(i\)</span>, and <span class="math inline">\(PO_i(t)\)</span> are the pseudo observations for time <span class="math inline">\(t\)</span>. We get the survival probability by merging with the life table estimates, and the pseudo observations from our package. The <code>prob</code> from the life tables is the probability of surviving one year, so to get the probability of surviving 5 and 10 years, we need to calculate the cumulative product estimates.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a></span>
<span id="cb22-2"><a href="#cb22-2"></a>lifetab[, prob<span class="fl">.5</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">prod</span>(lifetab[<span class="st">`</span><span class="dt">_age</span><span class="st">`</span> <span class="op">%in%</span><span class="st"> </span>.BY[[<span class="st">&quot;_age&quot;</span>]]<span class="op">:</span>(.BY[[<span class="st">&quot;_age&quot;</span>]]<span class="op">+</span><span class="dv">4</span>) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="st">                              `</span><span class="dt">_year</span><span class="st">`</span> <span class="op">%in%</span><span class="st"> </span>.BY[[<span class="st">&quot;_year&quot;</span>]]<span class="op">:</span>(.BY[[<span class="st">&quot;_year&quot;</span>]]<span class="op">+</span><span class="dv">4</span>) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="st">                                `</span><span class="dt">_year</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span>.BY[[<span class="st">&quot;_year&quot;</span>]] <span class="op">-</span><span class="st"> </span>.BY[[<span class="st">&quot;_age&quot;</span>]] <span class="op">+</span><span class="st"> `</span><span class="dt">_age</span><span class="st">`</span> <span class="op">&amp;</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="st">                              </span>sex <span class="op">==</span><span class="st"> </span>.BY[[<span class="st">&quot;sex&quot;</span>]] ]<span class="op">$</span>prob, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb22-6"><a href="#cb22-6"></a>        by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;_year&quot;</span>, <span class="st">&quot;_age&quot;</span>)]</span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a>lifetab[, prob<span class="fl">.10</span> <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">prod</span>(lifetab[<span class="st">`</span><span class="dt">_age</span><span class="st">`</span> <span class="op">%in%</span><span class="st"> </span>.BY[[<span class="st">&quot;_age&quot;</span>]]<span class="op">:</span>(.BY[[<span class="st">&quot;_age&quot;</span>]]<span class="op">+</span><span class="dv">9</span>) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="st">                              `</span><span class="dt">_year</span><span class="st">`</span> <span class="op">%in%</span><span class="st"> </span>.BY[[<span class="st">&quot;_year&quot;</span>]]<span class="op">:</span>(.BY[[<span class="st">&quot;_year&quot;</span>]]<span class="op">+</span><span class="dv">9</span>) <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="st">                                `</span><span class="dt">_year</span><span class="st">`</span> <span class="op">==</span><span class="st"> </span>.BY[[<span class="st">&quot;_year&quot;</span>]] <span class="op">-</span><span class="st"> </span>.BY[[<span class="st">&quot;_age&quot;</span>]] <span class="op">+</span><span class="st"> `</span><span class="dt">_age</span><span class="st">`</span> <span class="op">&amp;</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="st">                              </span>sex <span class="op">==</span><span class="st"> </span>.BY[[<span class="st">&quot;sex&quot;</span>]] ]<span class="op">$</span>prob, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </span>
<span id="cb22-12"><a href="#cb22-12"></a>        by =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;_year&quot;</span>, <span class="st">&quot;_age&quot;</span>)]</span>
<span id="cb22-13"><a href="#cb22-13"></a></span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a>colon2 &lt;-<span class="st"> </span><span class="kw">merge</span>(colon2, lifetab, </span>
<span id="cb22-16"><a href="#cb22-16"></a>                <span class="dt">by.x =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;yydx&quot;</span>, <span class="st">&quot;age&quot;</span>), </span>
<span id="cb22-17"><a href="#cb22-17"></a>                <span class="dt">by.y =</span> <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>,  <span class="st">&quot;_year&quot;</span>, <span class="st">&quot;_age&quot;</span>), <span class="dt">all.x =</span> <span class="ot">TRUE</span>, <span class="dt">all.y =</span> <span class="ot">FALSE</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a></span>
<span id="cb22-19"><a href="#cb22-19"></a>fit1 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(survival<span class="op">::</span><span class="kw">Surv</span>(surv_mm_trunc, death) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> colon2, <span class="dt">time =</span> <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>)</span>
<span id="cb22-20"><a href="#cb22-20"></a>fit5 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(survival<span class="op">::</span><span class="kw">Surv</span>(surv_mm_trunc, death) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> colon2, <span class="dt">time =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>)</span>
<span id="cb22-21"><a href="#cb22-21"></a>fit10 &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(survival<span class="op">::</span><span class="kw">Surv</span>(surv_mm_trunc, death) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> colon2, <span class="dt">time =</span> <span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>)</span>
<span id="cb22-22"><a href="#cb22-22"></a></span>
<span id="cb22-23"><a href="#cb22-23"></a>colon2<span class="op">$</span>po_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>fit1<span class="op">$</span>y</span>
<span id="cb22-24"><a href="#cb22-24"></a>colon2<span class="op">$</span>po_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>fit5<span class="op">$</span>y</span>
<span id="cb22-25"><a href="#cb22-25"></a>colon2<span class="op">$</span>po_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>fit10<span class="op">$</span>y</span>
<span id="cb22-26"><a href="#cb22-26"></a></span>
<span id="cb22-27"><a href="#cb22-27"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="dt">time =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>), </span>
<span id="cb22-28"><a href="#cb22-28"></a>                   <span class="dt">relsurv.pseudo =</span> <span class="kw">with</span>(colon2, </span>
<span id="cb22-29"><a href="#cb22-29"></a>                                  <span class="kw">c</span>(<span class="kw">mean</span>(po_<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>prob), </span>
<span id="cb22-30"><a href="#cb22-30"></a>                                    <span class="kw">mean</span>(po_<span class="dv">5</span> <span class="op">/</span><span class="st"> </span>prob<span class="fl">.5</span>), </span>
<span id="cb22-31"><a href="#cb22-31"></a>                                    <span class="kw">mean</span>(po_<span class="dv">10</span> <span class="op">/</span><span class="st"> </span>prob<span class="fl">.10</span>)),</span>
<span id="cb22-32"><a href="#cb22-32"></a>                                  ),</span>
<span id="cb22-33"><a href="#cb22-33"></a>                   <span class="dt">relsurv.pohar =</span> <span class="kw">c</span>(<span class="fl">0.682</span>, <span class="fl">0.479</span>, <span class="fl">0.441</span>)), <span class="dt">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">time</th>
<th align="right">relsurv.pseudo</th>
<th align="right">relsurv.pohar</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.677</td>
<td align="right">0.682</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0.477</td>
<td align="right">0.479</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">0.411</td>
<td align="right">0.441</td>
</tr>
</tbody>
</table>
<p>They are pretty close to those computed using the Pohar Perme estimator reported by Prof Lambert.</p>
</div>
<div id="case-cohort-sampling" class="section level1">
<h1>Case cohort sampling</h1>
<p><span class="citation">Parner, Andersen, and Overgaard (2020)</span> describe how to fit regression models with pseudo-observations that account for case-cohort sampling. The basic idea is weighted estimating equations, which we can implement easily with the <code>weights</code> argument that gets passed to <code>glm.fit</code>. First let’s create a case-cohort sample of the <code>colon2</code> dataset by sampling the cancer deaths (<code>status == 1</code>) with probability 0.8, and a random subcohort with probability 0.1.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>colon2<span class="op">$</span>status2 &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(colon2<span class="op">$</span>status <span class="op">==</span><span class="st"> </span><span class="dv">4</span>, <span class="dv">0</span>, colon2<span class="op">$</span>status), </span>
<span id="cb23-2"><a href="#cb23-2"></a>                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;censored&quot;</span>, <span class="st">&quot;cancer death&quot;</span>, <span class="st">&quot;other death&quot;</span>))</span>
<span id="cb23-3"><a href="#cb23-3"></a>subc &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="kw">nrow</span>(colon2), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">p =</span> <span class="fl">.2</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a>samp.ind &lt;-<span class="st"> </span>subc <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>subc) <span class="op">*</span><span class="st"> </span>(colon2<span class="op">$</span>status <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="kw">nrow</span>(colon2), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">p =</span> <span class="fl">.9</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>colon.cc &lt;-<span class="st"> </span>colon2[<span class="kw">as.logical</span>(samp.ind), ]</span>
<span id="cb23-6"><a href="#cb23-6"></a>colon.cc<span class="op">$</span>samp.wt &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">ifelse</span>(colon.cc<span class="op">$</span>status <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">.2</span> <span class="op">+</span><span class="st"> </span><span class="fl">.8</span> <span class="op">*</span><span class="st"> </span><span class="fl">.9</span>, <span class="fl">.2</span>)</span></code></pre></div>
<p>Now, the weighted regression model should give similar results as the unweighted one in the full sample:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>cfit.cc &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(surv_mm, status2) <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(subsite), </span>
<span id="cb24-2"><a href="#cb24-2"></a>                     <span class="dt">cause =</span> <span class="st">&quot;cancer death&quot;</span>, <span class="dt">time =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>, <span class="dt">data =</span> colon.cc, </span>
<span id="cb24-3"><a href="#cb24-3"></a>                     <span class="dt">weights =</span> samp.wt)</span>
<span id="cb24-4"><a href="#cb24-4"></a>cfit.full &lt;-<span class="st"> </span><span class="kw">cumincglm</span>(<span class="kw">Surv</span>(surv_mm, status2) <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(subsite), </span>
<span id="cb24-5"><a href="#cb24-5"></a>                     <span class="dt">cause =</span> <span class="st">&quot;cancer death&quot;</span>, <span class="dt">time =</span> <span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="dv">12</span>, <span class="dt">data =</span> colon2)</span>
<span id="cb24-6"><a href="#cb24-6"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="dt">casecohort =</span> cfit.cc<span class="op">$</span>coefficients, </span>
<span id="cb24-7"><a href="#cb24-7"></a>      <span class="dt">fullsamp =</span> cfit.full<span class="op">$</span>coefficients), <span class="dt">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">casecohort</th>
<th align="right">fullsamp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.24</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="right">0.02</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">factor(subsite)2</td>
<td align="right">0.07</td>
<td align="right">0.06</td>
</tr>
<tr class="odd">
<td align="left">factor(subsite)3</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">factor(subsite)4</td>
<td align="right">-0.02</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-overgaard2019pseudo">
<p>Overgaard, Morten, Erik Thorlund Parner, and Jan Pedersen. 2019. “Pseudo-Observations Under Covariate-Dependent Censoring.” <em>Journal of Statistical Planning and Inference</em> 202: 112–22.</p>
</div>
<div id="ref-overgaard2017asymptotic">
<p>Overgaard, Morten, Erik Thorlund Parner, Jan Pedersen, and others. 2017. “Asymptotic Theory of Generalized Estimating Equations Based on Jack-Knife Pseudo-Observations.” <em>The Annals of Statistics</em> 45 (5): 1988–2015.</p>
</div>
<div id="ref-parner2020cumulative">
<p>Parner, Erik T, Per K Andersen, and Morten Overgaard. 2020. “Cumulative Risk Regression in Case–Cohort Studies Using Pseudo-Observations.” <em>Lifetime Data Analysis</em>, 1–20.</p>
</div>
<div id="ref-pavlivc2019using">
<p>Pavlič, Klemen, and Maja Pohar Perme. 2019. “Using Pseudo-Observations for Estimation in Relative Survival.” <em>Biostatistics</em> 20 (3): 384–99.</p>
</div>
<div id="ref-perme2008checking">
<p>Perme, Maja Pohar, and Per Kragh Andersen. 2008. “Checking Hazard Regression Models Using Pseudo-Observations.” <em>Statistics in Medicine</em> 27 (25): 5309–28.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
